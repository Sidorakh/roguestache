<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>global.server_id=network_create_server(network_socket_tcp,7980, 4);
if global.server_id&lt;0{show_message("Hosting Failed! Check network setup") room_goto(room_title) exit}

default_buffer = buffer_create(256, buffer_grow, 1); //We have a buffer

gun_hold=0

global.my_players_x=0
global.my_players_y=0
global.my_players_spr=0
global.my_players_gun_spr=0
global.my_players_face=0
global.my_players_aim_dir=0
global.my_players_life=100


global.my_dummys_x=0
global.my_dummys_y=0
global.my_dummys_spr=0
global.my_dummys_gun_spr=0
global.my_dummys_face=0
global.my_dummys_aim_dir=0
global.my_dummys_life=100
global.sock=-1


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if instance_exists(player)
{
global.my_players_x=player.x
global.my_players_y=player.y
global.my_players_spr=player.spr
global.my_players_gun_spr=player.spr_gun
global.my_players_face=player.face
global.my_players_aim_dir=player.aim_dir
global.my_players_life=global.life

buffer_seek(default_buffer,buffer_seek_start, 0);//Take the buffer by the beginning
buffer_write(default_buffer, buffer_u16,DUMMY_STATS);
buffer_write(default_buffer, buffer_s16,player.x);
buffer_write(default_buffer, buffer_s16,player.y);
buffer_write(default_buffer, buffer_u16,player.spr);
buffer_write(default_buffer, buffer_u16,player.spr_gun);
buffer_write(default_buffer, buffer_s16,player.face);
buffer_write(default_buffer, buffer_u16,player.aim_dir);
buffer_write(default_buffer, buffer_s16,player.image_single);
buffer_write(default_buffer, buffer_s16,player.flip);
buffer_write(default_buffer, buffer_u16,player.gun);
buffer_write(default_buffer, buffer_s16,player.gun_x);
buffer_write(default_buffer, buffer_s16,player.gun_y);
network_send_packet(global.sock, default_buffer, buffer_tell(default_buffer));
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="68">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>var eventid = ds_map_find_value(async_load, "id"); //We are searching what data has “id”
//The variable “server” is the return of “network_create_server”
if( global.server_id == eventid ) //If that data is our server
{
var t = ds_map_find_value(async_load, "type"); //Connection or not

if t == network_type_connect
 {
data="Connection"
var sock = ds_map_find_value(async_load, "id"); //The sender
var ip = ds_map_find_value(async_load, "ip"); //The sender
}
 else
 {
data="Disconnected"
var sock = ds_map_find_value(async_load, "id"); //The sender
var ip = ds_map_find_value(async_load, "ip"); //The sender

 }
}
else
{
// We have a new packet
var buff = ds_map_find_value(async_load, "buffer"); //The content of the packet
var cmd = buffer_read(buff, buffer_u16 ); //The first data of each packet
var sock = ds_map_find_value(async_load, "id"); //The sender
global.sock=sock
//var sockid = ds_map_find_value(async_load, "id"); //The sender
switch (cmd) //The first data is telling what we are doing with the rest of the packet
{
case CLIENT_JOIN:
multiplayer_controler.my_string="Found a player"
buffer_seek(default_buffer,buffer_seek_start, 0);//Take the buffer by the beginning
buffer_write(default_buffer, buffer_u16,MAKE_DUMMY);
buffer_write(default_buffer, buffer_u16,room_width/2);
buffer_write(default_buffer, buffer_u16,room_height/2);
network_send_packet(sock, default_buffer, buffer_tell(default_buffer));

buffer_seek(default_buffer,buffer_seek_start, 0);//Take the buffer by the beginning
buffer_write(default_buffer, buffer_u16,MAKE_PLAYER);
buffer_write(default_buffer, buffer_u16,32+room_width/2);
buffer_write(default_buffer, buffer_u16,room_height/2);
network_send_packet(sock, default_buffer, buffer_tell(default_buffer));

instance_create(32+room_width/2,room_height/2,dummy)

global.waiting=0
instance_create(room_width/2,room_height/2,player)
break;

case DUMMY_STATS:
dummy.x=buffer_read(buff, buffer_s16 )
dummy.y=buffer_read(buff, buffer_s16 )
dummy.spr=buffer_read(buff, buffer_u16 )
dummy.spr_gun=buffer_read(buff, buffer_u16 )
dummy.face=buffer_read(buff, buffer_s16 )
dummy.aim_dir=buffer_read(buff, buffer_u16 )
dummy.image_single=buffer_read(buff, buffer_s16 )
dummy.flip=buffer_read(buff, buffer_s16 )
dummy.gun=buffer_read(buff, buffer_u16 )
dummy.gun_x=buffer_read(buff, buffer_s16 )
dummy.gun_y=buffer_read(buff, buffer_s16 )
break;

case DUMMY_SHOOT:
gun_hold=global.gun
global.gun=dummy.gun
with(dummy){shoot_gun1()}
global.gun=gun_hold
break;

case DUMMY_DIED:
with(dummy){instance_destroy()}
multiplayer_controler.alarm[2]=90
break;
}
}



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>buffer_seek(default_buffer,buffer_seek_start, 0);//Take the buffer by the beginning
buffer_write(default_buffer, buffer_u16,DUMMY_DIED);
network_send_packet(global.sock, default_buffer, buffer_tell(default_buffer));

multiplayer_controler.alarm[2]=90
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>buffer_seek(default_buffer,buffer_seek_start, 0);//Take the buffer by the beginning
buffer_write(default_buffer, buffer_u16,DUMMY_SHOOT);
network_send_packet(global.sock, default_buffer, buffer_tell(default_buffer));
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
